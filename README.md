# 蜀南竹海智慧景区服务

![Java](https://img.shields.io/badge/Java-17-orange)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.1.4-brightgreen)
![MySQL](https://img.shields.io/badge/MySQL-8.0-blue)
![Redis](https://img.shields.io/badge/Redis-6.0+-red)
![License](https://img.shields.io/badge/License-Open%20Source-lightgrey)

一个面向蜀南竹海景区的数字化服务后端系统，为微信小程序提供完整的景区管理和游客服务功能。

## 📑 目录

- [项目简介](#项目简介)
- [核心功能](#核心功能)
- [技术架构](#技术架构)
- [项目特色](#项目特色)
- [快速开始](#快速开始)
- [数据库](#数据库)
- [API 文档](#api-文档)
- [贡献指南](#贡献指南)
- [许可证](#许可证)

## 📖 项目简介

本项目是蜀南竹海景区的后端服务系统，致力于将传统景区与现代数字技术深度融合。系统采用 Spring Boot 微服务架构，集成微信小程序生态，为游客提供从行前规划、在线购票到智能导览的一站式数字化游览体验。

## ✨ 核心功能

### 🏞️ 景区管理

让景区运营更智能化。系统提供景点信息的全生命周期管理，从基础信息录入、图片展示到地理位置标注，一应俱全。景区设施按类型分层管理，便于游客快速找到所需服务。门票系统支持灵活的票型配置，无论是成人票、学生票还是儿童票，都能轻松应对不同需求。

### 💳 订单系统

打造流畅的购票体验。从游客下单的那一刻起，系统就全程护航——在线支付对接微信支付通道，安全可靠；订单状态实时同步，让游客心中有数；遇到行程变更？退款流程一键触发，快速到账；订单通知推送及时送达，不错过任何重要信息。后台还支持订单数据导出，方便运营分析和财务对账。

### 🤖 智能客服

24小时在线的景区向导。基于 LangChain4j 框架和阿里云通义千问大模型，AI 客服"竹小智"能够自然流畅地回答游客的各类问题。想知道明天天气？询问推荐路线？了解景点特色？通通不在话下。系统记录对话历史，支持多轮对话的上下文理解，让每次交流都像与真人客服聊天一样自然。

### 🎛️ 管理后台

为景区运营提供强大支撑。基于角色的权限控制保障数据安全，不同管理员各司其职。景区数据的增删改查操作界面友好，即使是非技术人员也能快速上手。用户画像与订单监控让运营决策有据可依，系统公告功能帮助及时传达重要信息，订阅消息推送让游客不错过精彩活动。

### 🔌 第三方服务

丰富的生态集成能力。高德地图 API 提供准确的天气预报和地理信息服务，帮助游客合理安排行程；MinIO 对象存储管理海量图片和文件资源，访问快速且稳定；微信小程序订阅消息在关键时刻主动触达用户，从支付成功到游玩提醒，让服务更贴心。

## 技术架构

### 后端框架
- **Spring Boot 3.1.4** - 主框架
- **Java 17** - 开发语言
- **MyBatis Plus** - ORM 框架
- **Spring Validation** - 参数校验
- **Spring AOP** - 切面编程

### 数据存储
- **MySQL** - 关系型数据库
- **Redis** - 缓存与会话管理
- **MinIO** - 对象存储服务

### 安全与认证
- **JWT** - 令牌认证
- **Spring Security Crypto** - 密码加密

### 工具与中间件
- **Knife4j** - API 文档生成
- **Quartz** - 定时任务调度
- **Apache POI** - Excel 数据导出
- **Hutool** - Java 工具类库

### AI 与集成
- **LangChain4j** - 大语言模型应用框架
- **阿里云通义千问** - 智能对话模型
- **WxJava SDK** - 微信小程序开发工具包

## 🎯 项目特色

- **🧠 智能问答**: 采用 RAG（检索增强生成）技术，结合景区知识库，让 AI 客服的回答更精准、更贴近实际场景
- **💰 支付闭环**: 从下单支付到退款处理，完整的微信支付流程集成，包括异步通知处理机制，保障资金安全
- **📢 主动触达**: 基于微信订阅消息的推送机制，在订单状态变更、活动通知等关键时刻主动联系用户
- **📊 数据导出**: 一键导出订单数据到 Excel，为运营分析和财务管理提供便利
- **⏰ 自动化运维**: 定时任务机制实现订单状态监控、过期提醒等自动化操作，减轻人工负担

## 🚀 快速开始

### 系统要求

- JDK 17 或更高版本
- MySQL 8.0+
- Redis 6.0+
- MinIO 对象存储服务
- Maven 3.6+

### 环境配置

1. 克隆项目到本地
2. 修改 `application.yml` 中的配置项，包括数据库连接、Redis 配置、微信小程序密钥等
3. 执行 `sql/cdu_snzh.sql` 脚本初始化数据库
4. 启动 Redis 和 MinIO 服务
5. 运行 `CduSnzhApplication.java` 启动应用

### 配置说明

项目的主要配置项位于 `application.yml`，包括：

- **数据库配置**: 数据库连接地址、用户名、密码
- **Redis 配置**: Redis 服务器地址和端口
- **MinIO 配置**: 对象存储服务的连接信息
- **微信配置**: 小程序 AppID、Secret、支付商户号等
- **AI 配置**: 通义千问 API Key 和模型参数
- **高德地图**: 地图服务 API Key

所有敏感配置支持通过环境变量注入，提升安全性。

## 💾 数据库

项目使用 MySQL 8.0 存储核心业务数据，主要包含以下数据表：

| 表名 | 说明 |
|------|------|
| `admin_user` | 管理员用户信息 |
| `app_user` | 小程序用户信息 |
| `scenic_spot` | 景点基础信息 |
| `scenic_image` | 景点图片资源 |
| `scenic_ticket` | 景区门票信息 |
| `ticket_type` | 门票类型配置 |
| `orders` | 订单主表 |
| `order_item` | 订单明细表 |
| `facility` | 景区设施信息 |
| `facility_type` | 设施类型分类 |
| `notification_record` | 消息通知记录 |
| `ai_chat_message` | AI 客服对话记录 |
| `ai_chat_session` | AI 会话管理 |

完整的数据库结构文件位于 `sql/cdu_snzh.sql`。

## 📚 API 文档

项目集成了 Knife4j 在线 API 文档，启动项目后访问：

```
https://v0d2kkgn6c.apifox.cn/
```

文档提供了完整的接口说明、参数定义和在线调试功能。

## 🤝 贡献指南

我们欢迎任何形式的贡献，无论是新功能、Bug 修复还是文档改进。

### 贡献流程

1. Fork 本仓库
2. 创建你的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交你的修改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 提交 Pull Request

### 代码规范

- 遵循 Java 编码规范
- 保持代码注释的完整性
- 确保新功能有相应的测试用例
- 提交前运行 `mvn clean test` 确保测试通过

## 📄 许可证

本项目采用 MIT License 开源许可协议。详见 [LICENSE](LICENSE) 文件。

---

**Made with ❤️ for 蜀南竹海景区**